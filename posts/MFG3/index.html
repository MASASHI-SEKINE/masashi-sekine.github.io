<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>関根 雅のHP</title>

<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="../../css/menu2.css">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax:{inlineMath:[['\$','\$'],['\\(','\\)']],processEscapes:true},CommonHTML: {matchFontHeight:false}});</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <header id="header">
    <h1>平均場ゲーム理論の概要③</h1>
  </header>
  <a href="../../posts.html"><button class="fixed_btn">記事一覧へ戻る</button></a>
  <div class="openbtn1"><span></span><span></span><span></span></div>
  <nav id="g-nav">
  <div id="g-nav-list">
  <ul>
  <li><a href="../../index.html">ホーム</a></li>
  <li><a href="../../profile_jp.html">プロフィール</a></li>
  <li><a href="../../research_jp.html">研究活動</a></li>
  <li><a href="../../posts.html">記事</a></li>
  </ul>
  </div>
  </nav>

  <p>  　本記事では主に[3]と[4]に基づいて確率論的アプローチによるCommon Noiseがない場合の平均場ゲーム理論を数学的に説明する。
  </p>
  <h1col>13. 多人数ゲームの定式化</h1col>
  <p>  </p>
  $N$人のプレイヤーがいるゲームを考えてみる. プレイヤー$i$はコスト関数$J^i(\alpha)$を最小化しようと$\alpha^i$を選ぶ;
\begin{equation*}
\begin{split}
J^i(\alpha)=\mathbb{E}\left[\int_0^T f^i(s,X_s,\alpha_s)ds + g^i(X_T)\right]
\end{split}
\end{equation*}
ここで, $X$は各プレイヤーの状態を表し, それぞれ次のSDEに従う;
\begin{equation*}
\begin{split}
X_t^i = \xi^i + \int_0^t B^i(s,X_s,\alpha_s)ds + \int_0^t \Sigma^i(s,X_s,\alpha_s) dW_s^i
\end{split}
\end{equation*}
"Nash均衡"とは, "自分1人だけが戦略を変更しても利得が増えることはない"という状態をいうが, 以上の設定では次のように定義できる. 
<div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">
定義
    戦略$(\hat{\alpha}^1,\cdots,\hat{\alpha}^N)\in \mathbb{A}^N$がNash均衡であるとは, 各$i\in\{1,\cdots,N\}$と任意の戦略$\beta^i\in \mathbb{A}$について,
    \begin{equation*}
    \begin{split}
    J^i(\hat{\alpha}^1,\cdots,\hat{\alpha}^N)\leq J^i(\beta^i,\hat\alpha^{-i})
    \end{split}
    \end{equation*}
    が成り立つことを言う.
  </div>
  次の関数はHamiltonianと呼ばれ, 以降頻繁に使う.
  \begin{equation*}
      \begin{split}
      H(t,\omega,x,y,z,\alpha)=B(t,\omega,x,\alpha)\cdot y + \Sigma(t,\omega,x,\alpha)\cdot z + f(t,x,\alpha)
      \end{split}
  \end{equation*}
  そして, 多人数ゲームの均衡を考えるにさしあたり各人の状態過程$X$の随伴過程$(Y,Z)$を次のBSDEにより導入する.
  \begin{equation*}
      \begin{split}
        Y_t^i = \partial_x g^i(X_T) + \int_t^T \partial_x H^i(s,X_s,Y_s^i,Z_s^i,\alpha_s)ds-\int_t^T Z_s^i dW_s
      \end{split}
  \end{equation*}
  すると, 各人の状態過程$X$とその随伴過程$(Y,Z)$によって$N$個の連立したFBSDEを考えることができる;
  \begin{equation}
      \begin{split}
        X_t &= \xi + \int_0^t B(s,X_s,\hat{\alpha}(s,X_s,Y_s,Z_s)) ds + \int_0^t \Sigma(s,X_s,\hat{\alpha}(s,X_s,Y_s,Z_s)) dW_s\\
        Y_t^i &= \partial_x g^i(X_T) + \int_t^T \partial_x H^i(s,X_s,Y_s^i,Z_s^i,\hat{\alpha}(s,X_s,Y_s,Z_s)))ds-\int_t^T Z_s^i dW_s
      \end{split}
  \end{equation}
  この連立FBSDEを解くことで多人数ゲームの均衡解を求めることができる.
  <div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">
    定理
  $(\hat{X},\hat{Y},\hat{Z})$がFBSDE(1)の解であったとする. 一定の仮定のもと, $\hat\alpha\in\mathbb{A}$がNash均衡となる必要十分条件は各$i\in\{1,\cdots,N\}$について
  \begin{equation*}
  \begin{split}
  H^i(t,\hat{X}_t,\hat{Y}^i_t,\hat{Z}^i_t,\hat{\alpha}_t)=\inf_{\alpha\in A}H^i(t,\hat{X}_t,\hat{Y}^i_t,\hat{Z}^i_t,(\alpha,\hat{\alpha}_t^{-i}))
  \end{split}
  \end{equation*}
  となることである.
</div>
しかしながら, FBSDE(1)については, 関数の形にもよるが, 一般的な仮定では解の存在や一意性は担保されないし, 数値計算をするにしても非常に困難である. これが, 多人数ゲームの厳密な求解を難しくしている所以である.
<p>  </p>
<h1col>14. 多人数ゲームから平均場ゲームへ</h1col>
<p>  </p>
<div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">考え方
    プレイヤーは同質で, プレイヤー間の相互作用は対称であると仮定してみる. 
  </div>
    このとき, 多人数ゲームの問題は経験分布を用いて
    \begin{equation*}
        \begin{split}
        J^i(\alpha)=\mathbb{E}\left[\int_0^T f(s,X_s^i,\bar{\mu}^{N-1}_{X_s,\alpha_s},\alpha_s)ds + g^i(X_T^i, \bar{\mu}^{N-1}_T)\right]
        \end{split}
        \end{equation*} 
    \begin{equation*}
    \begin{split}
        X^i_t =\xi^i + \int_0^t B(s,X_s^i, \bar{\mu}^{N-1}_{X_s,\alpha_s}, \alpha_s^i) ds + \int_0^t \Sigma(s,X_s^i, \bar{\mu}^{N-1}_{X_s,\alpha_s}, \alpha_s^i) dW_s
    \end{split}
    \end{equation*}
    と書けると期待できる.

    <p>  </p>
<h1col>15. 平均場ゲーム理論</h1col>
<p> 平均場ゲームの問題は<br>
  (I) 各人の最適制御問題<br>
  (II) 自己無撞着問題<br>
  の2つから成り立っている. </p>

<p> <div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">(I) 各人の最適制御問題
  確率測度の時間発展プロセス$\mu:[0,T]\to\mathcal{P}_2(\mathbb{R}^d)$をまずは所与として, 次の確率最適制御問題を解く;
  \begin{equation*}
      \begin{split}
      \inf_{\alpha\in \mathbb{A}}\mathbb{E}\left[\int_0^T f(s,X_s,\mu_s,\alpha_s)ds + g(X_T,\mu_T)\right]
      \end{split}
  \end{equation*}
      subject to
  \begin{equation*}
      \begin{split}
      X_t = \xi + \int_0^t B(s,X_s,\mu_s,\alpha_s)ds + \int_0^t \Sigma(s,X_s,\mu_s,\alpha_s)dW_s
      \end{split}
  \end{equation*}
</div>

<div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">(II) 自己無撞着問題
(I)で所与とした分布と(I)の解が整合的になる分布($=$固定点)を探す.
  \begin{equation*}
      \begin{split}
      \mu^* = \mathcal{L}(\hat X^{\mu^*})
      \end{split}
  \end{equation*}
  となるような$\mu^*$を見つける. ただし, $\hat X^{\mu^*}$は, $\mu^*$を所与としたときの(I)の解である.
</div> </p>

<p>多人数ゲームのときと同様に各人の状態過程$X$の随伴過程$(Y,Z)$を導入する.
    \begin{equation*}
        \begin{split}
          Y_t = \partial_x g(X_T,\mu_T) + \int_t^T \partial_x H(s,X_s,\mu_s,Y_s,Z_s,\alpha_s)ds-\int_t^T Z_s dW_s
        \end{split}
    \end{equation*}
    また, Hamiltonianも同様に定義する.
    \begin{equation*}
        \begin{split}
        &H(t,\omega,x,\mu,y,z,\alpha)=B(t,\omega,x,\mu,\alpha)\cdot y + \Sigma(t,\omega,x,\mu,\alpha)\cdot z+ f(t,x,\mu,\alpha)
        \end{split}
    \end{equation*}
  
    各人の状態過程$X$とその随伴過程$(Y,Z)$によって1つの無限次元FBSDEを考えることができる;
    \begin{equation}
        \begin{split}
            X_t &= \xi + \int_0^t B(s,X_s,\mu_s,\hat\alpha(s,X_s,\mu_s,Y_s))ds + \int_0^t \Sigma(s,X_s)dW_s\\
            Y_t &= \partial_xg(X_T,\mu_T)+\int_t^T\partial_x H(s,X_s,\mu_s,Y_s,\hat\alpha(s,X_s,\mu_s,Y_s))ds -\int_t^T Z_sdW_s
          \end{split}
        \end{equation}



        <div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">定理
        $(\hat{X},\hat{Y},\hat{Z})$がFBSDE(2)の解であったとする. 一定の仮定のもと, $\hat\alpha\in\mathbb{A}$が各$t\in[0,T]$で$H(t,\hat{X}_t,\mu_t,\hat{Y}_t,\hat{Z}_t,\cdot)$の最小値を与える点であるとき, 任意の$\alpha\in\mathbb{A}$について
        \begin{equation*}
            \begin{split}
            J(\hat\alpha)+\lambda\mathbb{E}\left[\int_0^T|\hat\alpha_t-\alpha_t|^2dt\right]\leq J(\alpha)
            \end{split}
        \end{equation*}
        が成り立つ.
      </div> </p>

      <p> 以上の観察により, (I) 各人の最適制御問題はFBSDE (2)を解くことにより得られる. そして, (II) 自己無撞着問題については
      \begin{equation*}
          \begin{split}
          \mu_t = \mathcal{L}(\hat X_t)
          \end{split}
      \end{equation*}
      となるように$\mu$を定めれば良い. 換言すれば, これら2つを合わせたFBSDE;
      \begin{equation}
          \begin{split}
            X_t &= \xi + \int_0^t B(s,X_s,\mathcal{L}(X_s),\hat\alpha(s,X_s,\mathcal{L}(X_s),Y_s))ds + \Sigma W_t\\
            Y_t &= \partial_xg(X_T,\mathcal{L}(X_T))+\int_t^T\partial_x H(s,X_s,\mathcal{L}(X_s),Y_s,\hat\alpha(s,X_s,\mathcal{L}(X_s),Y_s))ds -\int_t^T Z_sdW_s
          \end{split}
      \end{equation}
      を解けば, (I)と(II)をいっぺんに解くこととなり, 平均場ゲームの解を求めることができる. このように解の分布が係数関数に入った無限次元FBSDEをMcKean-Vlasov型FBSDEと呼ぶ.
  
      <div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">定理
          一定の仮定のもとで, McKean-Vlasov型FBSDE(3)は解を持つ.
        </div>
  
        <div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">注意
          McKean-Vlasov型FBSDE(3)の解は一意とは限らない.
        </div>
</p>



<h1col>16. 平均場ゲームと多人数ゲームの関係〜$\varepsilon$-Nash均衡〜</h1col>
<p>ここでは, 平均場ゲームの解が多人数ゲーム均衡を近似していることを示す. まずは"均衡の近似"という概念を定義する.
  <div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">定理
      $\varepsilon>0$とする. $(\hat{\alpha}^1,\cdots,\hat{\alpha}^N)$が$\varepsilon$-Nash均衡であるとは, 任意の$i$と戦略$\beta^i\in\mathbb{A}$について,
      \begin{equation*}
      \begin{split}
      J^i(\hat{\alpha}^1,\cdots,\hat{\alpha}^N)\leq J^i(\beta^i,\hat{\alpha}^{-i})+\varepsilon
      \end{split}
      \end{equation*}
      となることをいう
    </div>

  次のような状態プロセスを考える.
  \begin{equation*}
      \begin{split}
        &X^{N,i}_t = \xi^i + \int_0^t B(s,X_s^{N,i},\bar\mu^N_s,\hat\alpha(s,X_s^{N,i},\mu_s,u(s,X_s^{N,i}))) ds ¥+\int_0^t \Sigma_0(s,\bar\mu^N_s)dW_s
      \end{split}
  \end{equation*}
      ただし, $\mu\in\mathcal{C}([0,T];\mathcal{P}_2(\mathbb{R}^d))$は平均場ゲームの均衡で, 初期条件$\mu_0 = \mathcal{L}(\xi^i)$を満たすものとする. 換言すれば, $X^{N,i}$は$N$人ゲームにおいて, 周囲の環境を$\mu$だと思って各々が戦略をとった時の$i$の状態プロセスである. $u$は$u(t,X_t)=Y_t$を満たす関数である.
  \begin{equation*}
      \begin{split}
      \hat\alpha^{N,i}:=\hat\alpha(t,X_t^{N,i},\mu_t,u(t,X_t^{N,i}))
      \end{split}
  \end{equation*}
  と書くことにする. 


  次の定理は, 平均場ゲームの均衡が多人数ゲーム均衡の均衡の近似になっていることを示している.
  <div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">定理
      一定の仮定のもと, $\hat\alpha^{N,i}$は$N$人ゲームの$\varepsilon_N$-Nash均衡になる. ここで, $(\varepsilon_N)_{N\in\mathbb{N}}$は$N\to\infty$において0に収束する列である. すなわち, 任意の$i$と戦略$\beta^i\in\mathbb{A}$について,
      \begin{equation*}
          \begin{split}
          J^i(\hat{\alpha}^{N,1},\cdots,\hat{\alpha}^{N,N})\leq J^i(\beta^i,\hat{\alpha}^{N,-i})+\varepsilon_N
          \end{split}
          \end{equation*}
        が成立する.</div> </p>

<h1col>17. 平均場ゲームと多人数ゲームの関係〜Propagation of Chaos〜</h1col>
<p><div style = "padding: 10px; margin-bottom: 10px; border: 5px double #333333;">定理
        多人数ゲームの状態プロセス;
        \begin{equation*}
            \begin{split}
            X_t^{N,i}= X^i_0 +\int_0^t B(s,X_s^{N,i},\bar\mu_s^N)ds + \int_0^t \Sigma(s,X_s^{N,i},\bar\mu_s^N)dW_s^i
            \end{split}
        \end{equation*}
        そして, 平均場ゲームの状態プロセス (McKean-Vlasov SDE)
        \begin{equation*}
            \begin{split}
            \underline{X}_t^i = X^i_0 + \int_0^t B(s,\underline{X}_s^i,\mathcal{L}(\underline{X}_s^i))ds + \int_0^t \Sigma(s,\underline{X}_s^i,\mathcal{L}(\underline{X}_s^i))dW_s^i
            \end{split}
        \end{equation*}
        を考える.
    一定の仮定のもと, 両者は一意な解をもつ. さらに,
        \begin{equation*}
            \begin{split}
            &\lim_{N\to \infty}\left(\max_{i\in\{1,\cdots,N\}}\mathbb{E}\left[\sup_{t\in[0,T]}|X_t^{N,i}-\underline{X}_t^i|^2\right]+\sup_{t\in[0,T]}\mathbb{E}\left[W_2\left(\frac{1}{N}\sum_{i=1}^N \delta_{X_t^{N,i}},\mathcal{L}(\underline{X}_s^i)\right)^2\right]\right)=0
            \end{split}
        \end{equation*}
        が成立する.
      </div> </p>

      <h1col>参考文献</h1col>
      <p>$[1]Carmona, R. \& Delarue, F., 2018, \textit{Probabilistic Theory of Mean Field Games with Applications I}, Springer International Publishing, Switzerland.$</p>
      <p>$[2]Carmona, R. \& Delarue, F., 2018, \textit{Probabilistic Theory of Mean Field Games with Applications II}, Springer International Publishing, Switzerland.$</p>
      <p>$[3]Carmona, R. \& Delarue, F., 2013, \textit{Probabilistic analysis of mean-field games}, SIAM Journal on Control and Optimization, Vol. 51, No. 4, pp. 2705-2734.$</p>
      <p>$[4]Carmona, R. \& Delarue, F., 2015, \textit{Forward-backward stochastic differential equations and controlled McKean-Vlasov dynamics}, The Annals of Probability, Vol. 43, No. 5, pp. 2647-2700.$</p>
      <p>$[5] Fudenberg, D. \& Tirole, J., 1991, \textit{Game Theory}. MIT Press.$</p>
      <p>$[6]Huang, M.,Malhame R.P \& Caines, P.E., 2006, \textit{Large population stochastic dynamic games: closedloop McKean-Vlasov systems and the Nash certainty equivalence principle}, Communications in Information and Systems, Vol.6, No. 3, pp. 221-252.$</p>
      <p>$[7]Lasry, J.M. \& Lions, P.L., 2007, \textit{Mean field games}, Japanese Journal of Mathematics Vol. 2, pp. 229-260.$</p>
      <p>$[8]Mas-colell, A., Whinston, M. \& Green, J., 1995, \textit{Microeconomic Theory}, Oxford University Press, New York$</p>
  <p>$[9] Peng, S. \& Wu, Z., 1999, \textit{Fully coupled forward-backward stochastic differential equations and applications to optimal control.} SIAM Journal on Control and Optimization, 37, pp. 825-843.$</p>
  <p>$[10] Zhang, J., 2017, \textit{Backward Stochastic Differential Equations: From Linear to Fully Nonlinear Theory.} Springer, New York Heidelberg Berlin.$</p>



  <p>[<a href="../MFG2/index.html">平均場ゲーム理論の概要②に戻る</a>]</p>
</section>
  <footer id="footer">
  <small></small>
  </footer>

<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="../../js/index.js"></script>
</body>
</html>
